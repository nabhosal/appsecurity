package io.github.nabhosal.secureapp.test;

import io.github.nabhosal.secureapp.exception.CertificateExpiredException;
import io.github.nabhosal.secureapp.exception.SecurityContextException;
import io.github.nabhosal.secureapp.utils.CertificateUtil;
import io.github.nabhosal.secureapp.SecurityContext;
import io.github.nabhosal.secureapp.SecurityContextBuilder;
import io.github.nabhosal.secureapp.utils.Obfuscator;
import org.junit.Test;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.time.LocalDateTime;

import static junit.framework.TestCase.assertFalse;
import static junit.framework.TestCase.assertTrue;

public class TestSecurityContext {

    private static String PRIVATE_KEY = "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC3ee2oXPQmii0Kb0Ye8FUs4J7ZKUSLFChBP4gVRWcqgeXcfsDbeNig1ZOPwq0GBBp9wQWx3iTRABYL0BDSsWKdymGh36ajJn5Ne7ebJCLo/nclcUD7RaEQeD5TzwN3hdqeLX595xVJakyQLhpME4/F2ZGqFa8nFUvSHyrdxdN0EFyYo4z5clpGT5qqhXxIuQ+4NT8ghRhZAqP0Fvn+HlbhzRAeKJxQW/nWK1PVsCZw5Nn0uLWTyosdInhOOIoTnFTgyXoMtmDZCKtt/tIpaw5rqwLczUYZMp57h8qSPmM9fIHIgFhuEEWqSTTs0pRP+TSoYkDMTYsWuXCA8Z3dY2d/AgMBAAECggEAcUyT28H66sms4qKwNG7IyjuzG/sF3rSF3zTyPeBrwq4QWcbUJTNM4pTA2Keo3Owvx7QoZhv9tCpPct/7Y4Aym6nb/G/1oQ4mNIbPbLg17pck0DRNolzvBxKZuns9ctNvmvoRAIJwfLNtsCMoDg6OW+jssJFPZd0awxiICgcdeq+LS4pJ+uFPgc//cFJmD0LV60HUiT0Y1P63wxvmva5MHHEhbCo2eJVXVrxYyGGaWmgW4VPUsQSvohF/2oPjhzeHoStSbDqgEiQkJsM+yWCaIdE4nWxU+YBgRcg/uuBxxp1ZaOm1tuak4G3ap7F4mTQfkPapZBodnfNsMZg5x3SSAQKBgQDrVS990nMgovumVKgf2qbjD1zoLfGxDBTlZWX3+sMan0JGEKUcATFdwx+IODd2cyyf7qePj+J6REQRRXmvEwzuTvAIpza+T7ABRp6crxIkRu0T908Kylt/MBNkzgl8vkzOOmEDCCdOBzZp0z2mu9/v7NeasoJ4anxWkn5gQTXp/wKBgQDHluRBHiVArX133pOABTYCHMvXZw8e3vdN0oR2osg3JORmTSb6Vs8dmTC3DVULQgJBEv3+hmi504+I02i5jsRqxzgqigQxnk7r2LaryhR5VC0I2lqaW8yl+t/813k55oPyURxLFVgPaiz5i78oCT7gRiX3mIza+y0vWzyHDZuCgQKBgDOnegojFFQYkiX7NP/w7WqvZ5Qq6X8UCM4lSJF6wDJqvJBGfQc9l8ld1+D9fecI9sWQC8VuLqbprwsfdcsg4li4iOVNVq3FLfvJtWzs3I2L5+PXB8l1i0nKkqcwtlJkLtWhaMPSmVX+LUpjLIgZetjd4qE5B3xI20vhUc3s4lmfAoGAUFOiObLwOz+Xp46kvnlaay87us13gG0sCt4XAcgx3D+0zJdwgIA/iyIEQSfUeltunNIP90gRDfjfY6nyE/wpgO/84uH5Hh8glDr8CdeitdHy7gUzQbyAeKynSRNPbsYfhH6wbGeCsXGB+E0N+gb+jzSsQyHaTqeYX97QVWpclAECgYAr7PuvH7pFfxDl49juGHXJBN1YmnrTGd4r6Uxv91XXIruIY3lCkRWh2auSS3DKgC0CnPMzSfhVEWH+OuTrd3UdyuXZXJKWcNjTkb9k1rshHIxeSfa+8ROU82WQEEH2idkzgr9qYvNjATqInc05KaJqmj2LkNXneYh1PUUxgCupoA==";
    private static String PUBLIC_KEY = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt3ntqFz0JootCm9GHvBVLOCe2SlEixQoQT+IFUVnKoHl3H7A23jYoNWTj8KtBgQafcEFsd4k0QAWC9AQ0rFincphod+moyZ+TXu3myQi6P53JXFA+0WhEHg+U88Dd4Xani1+fecVSWpMkC4aTBOPxdmRqhWvJxVL0h8q3cXTdBBcmKOM+XJaRk+aqoV8SLkPuDU/IIUYWQKj9Bb5/h5W4c0QHiicUFv51itT1bAmcOTZ9Li1k8qLHSJ4TjiKE5xU4Ml6DLZg2Qirbf7SKWsOa6sC3M1GGTKee4fKkj5jPXyByIBYbhBFqkk07NKUT/k0qGJAzE2LFrlwgPGd3WNnfwIDAQAB";
    private static String OBFUSCATED_PUBLIC_KEY = (new Object() {int t;public String toString() {byte[] buf = new byte[392];t = -374855393;buf[0] = (byte) (t >>> 21);t = 1233261869;buf[1] = (byte) (t >>> 24);t = -766304181;buf[2] = (byte) (t >>> 22);t = 356661191;buf[3] = (byte) (t >>> 16);t = -50704785;buf[4] = (byte) (t >>> 11);t = -151472777;buf[5] = (byte) (t >>> 7);t = -1596327440;buf[6] = (byte) (t >>> 23);t = -1474008624;buf[7] = (byte) (t >>> 5);t = 338858142;buf[8] = (byte) (t >>> 6);t = -1360566882;buf[9] = (byte) (t >>> 2);t = -1492113194;buf[10] = (byte) (t >>> 1);t = 955248336;buf[11] = (byte) (t >>> 23);t = -317500319;buf[12] = (byte) (t >>> 21);t = 2146283515;buf[13] = (byte) (t >>> 10);t = 1795914568;buf[14] = (byte) (t >>> 3);t = 37231553;buf[15] = (byte) (t >>> 19);t = 70575174;buf[16] = (byte) (t >>> 10);t = 1284225610;buf[17] = (byte) (t >>> 11);t = -1906763772;buf[18] = (byte) (t >>> 7);t = 1990744402;buf[19] = (byte) (t >>> 13);t = -492776020;buf[20] = (byte) (t >>> 15);t = -576051684;buf[21] = (byte) (t >>> 13);t = 975970751;buf[22] = (byte) (t >>> 19);t = 1413769893;buf[23] = (byte) (t >>> 12);t = -1542470394;buf[24] = (byte) (t >>> 2);t = 1603302941;buf[25] = (byte) (t >>> 14);t = 910818480;buf[26] = (byte) (t >>> 13);t = -391210738;buf[27] = (byte) (t >>> 2);t = -1664869987;buf[28] = (byte) (t >>> 12);t = 2091536878;buf[29] = (byte) (t >>> 8);t = 1311736952;buf[30] = (byte) (t >>> 22);t = 779944995;buf[31] = (byte) (t >>> 10);t = 1565002155;buf[32] = (byte) (t >>> 5);t = -728569692;buf[33] = (byte) (t >>> 17);t = 1230371533;buf[34] = (byte) (t >>> 24);t = 1111566614;buf[35] = (byte) (t >>> 24);t = -519211840;buf[36] = (byte) (t >>> 18);t = 346874695;buf[37] = (byte) (t >>> 13);t = 1518553977;buf[38] = (byte) (t >>> 8);t = -1808703394;buf[39] = (byte) (t >>> 20);t = -1597062272;buf[40] = (byte) (t >>> 23);t = -262908076;buf[41] = (byte) (t >>> 14);t = 170484185;buf[42] = (byte) (t >>> 19);t = 276542115;buf[43] = (byte) (t >>> 22);t = 780261602;buf[44] = (byte) (t >>> 21);t = 1054421820;buf[45] = (byte) (t >>> 4);t = -699995809;buf[46] = (byte) (t >>> 12);t = -1608832091;buf[47] = (byte) (t >>> 3);t = 1997714131;buf[48] = (byte) (t >>> 20);t = -1427583261;buf[49] = (byte) (t >>> 13);t = -1137805407;buf[50] = (byte) (t >>> 4);t = -1689511876;buf[51] = (byte) (t >>> 14);t = -130771695;buf[52] = (byte) (t >>> 9);t = -1394020895;buf[53] = (byte) (t >>> 5);t = -1133555705;buf[54] = (byte) (t >>> 16);t = 591032803;buf[55] = (byte) (t >>> 15);t = 1250369457;buf[56] = (byte) (t >>> 17);t = 826006340;buf[57] = (byte) (t >>> 6);t = -1049781008;buf[58] = (byte) (t >>> 7);t = 1455367081;buf[59] = (byte) (t >>> 7);t = 1513391514;buf[60] = (byte) (t >>> 12);t = -1226031220;buf[61] = (byte) (t >>> 17);t = 937832068;buf[62] = (byte) (t >>> 1);t = 1286440887;buf[63] = (byte) (t >>> 17);t = -1053584632;buf[64] = (byte) (t >>> 18);t = -1074984322;buf[65] = (byte) (t >>> 3);t = 1124326709;buf[66] = (byte) (t >>> 24);t = 65227564;buf[67] = (byte) (t >>> 3);t = 677712905;buf[68] = (byte) (t >>> 17);t = 825927250;buf[69] = (byte) (t >>> 9);t = 734149040;buf[70] = (byte) (t >>> 2);t = -1659567780;buf[71] = (byte) (t >>> 18);t = 915909379;buf[72] = (byte) (t >>> 20);t = -2084133227;buf[73] = (byte) (t >>> 19);t = -988780835;buf[74] = (byte) (t >>> 20);t = 1454169676;buf[75] = (byte) (t >>> 9);t = 170534700;buf[76] = (byte) (t >>> 21);t = -896404152;buf[77] = (byte) (t >>> 4);t = 925583852;buf[78] = (byte) (t >>> 16);t = -1556011208;buf[79] = (byte) (t >>> 10);t = 281733681;buf[80] = (byte) (t >>> 3);t = 1152049583;buf[81] = (byte) (t >>> 15);t = 1867956003;buf[82] = (byte) (t >>> 16);t = 2109234510;buf[83] = (byte) (t >>> 18);t = 1607959728;buf[84] = (byte) (t >>> 4);t = 1420735354;buf[85] = (byte) (t >>> 3);t = 1279792445;buf[86] = (byte) (t >>> 16);t = 1358669017;buf[87] = (byte) (t >>> 1);t = -471825603;buf[88] = (byte) (t >>> 4);t = 1211220463;buf[89] = (byte) (t >>> 24);t = 465296518;buf[90] = (byte) (t >>> 23);t = -1330569034;buf[91] = (byte) (t >>> 7);t = -376182527;buf[92] = (byte) (t >>> 19);t = -1087135786;buf[93] = (byte) (t >>> 16);t = 556866209;buf[94] = (byte) (t >>> 6);t = -298755734;buf[95] = (byte) (t >>> 8);t = 1937722198;buf[96] = (byte) (t >>> 19);t = -515157108;buf[97] = (byte) (t >>> 6);t = 212806594;buf[98] = (byte) (t >>> 7);t = -1894471286;buf[99] = (byte) (t >>> 9);t = 897386380;buf[100] = (byte) (t >>> 23);t = -1372862351;buf[101] = (byte) (t >>> 1);t = -208485195;buf[102] = (byte) (t >>> 14);t = -499944247;buf[103] = (byte) (t >>> 8);t = 453532840;buf[104] = (byte) (t >>> 13);t = -1851154950;buf[105] = (byte) (t >>> 10);t = -2082469235;buf[106] = (byte) (t >>> 3);t = 1016621326;buf[107] = (byte) (t >>> 14);t = 355887744;buf[108] = (byte) (t >>> 12);t = -423203553;buf[109] = (byte) (t >>> 17);t = 1630163285;buf[110] = (byte) (t >>> 6);t = 1175216755;buf[111] = (byte) (t >>> 24);t = -590374848;buf[112] = (byte) (t >>> 22);t = -523556882;buf[113] = (byte) (t >>> 11);t = 40455931;buf[114] = (byte) (t >>> 17);t = 1475980743;buf[115] = (byte) (t >>> 10);t = 483760231;buf[116] = (byte) (t >>> 7);t = 11055998;buf[117] = (byte) (t >>> 15);t = 1236746370;buf[118] = (byte) (t >>> 1);t = 1482392925;buf[119] = (byte) (t >>> 2);t = 409897499;buf[120] = (byte) (t >>> 3);t = -1580353699;buf[121] = (byte) (t >>> 19);t = 673401521;buf[122] = (byte) (t >>> 21);t = 909461499;buf[123] = (byte) (t >>> 10);t = -779911407;buf[124] = (byte) (t >>> 19);t = 531862539;buf[125] = (byte) (t >>> 11);t = 9382097;buf[126] = (byte) (t >>> 5);t = -631063940;buf[127] = (byte) (t >>> 22);t = 678759132;buf[128] = (byte) (t >>> 1);t = -973501059;buf[129] = (byte) (t >>> 10);t = 207885189;buf[130] = (byte) (t >>> 3);t = 91376336;buf[131] = (byte) (t >>> 1);t = 1539984009;buf[132] = (byte) (t >>> 22);t = -1842195046;buf[133] = (byte) (t >>> 15);t = 1140000102;buf[134] = (byte) (t >>> 5);t = -153423387;buf[135] = (byte) (t >>> 20);t = -1447257170;buf[136] = (byte) (t >>> 18);t = 754153153;buf[137] = (byte) (t >>> 17);t = 1524396291;buf[138] = (byte) (t >>> 24);t = -1126754906;buf[139] = (byte) (t >>> 7);t = -1253470692;buf[140] = (byte) (t >>> 20);t = -1564213694;buf[141] = (byte) (t >>> 19);t = -1164089508;buf[142] = (byte) (t >>> 14);t = -1080351123;buf[143] = (byte) (t >>> 5);t = 1494555488;buf[144] = (byte) (t >>> 6);t = -817858080;buf[145] = (byte) (t >>> 8);t = 832217816;buf[146] = (byte) (t >>> 9);t = -26829081;buf[147] = (byte) (t >>> 12);t = 2068223192;buf[148] = (byte) (t >>> 2);t = 678789973;buf[149] = (byte) (t >>> 23);t = -205086352;buf[150] = (byte) (t >>> 13);t = -1478439047;buf[151] = (byte) (t >>> 10);t = -1868209479;buf[152] = (byte) (t >>> 15);t = -1892914994;buf[153] = (byte) (t >>> 15);t = -1452503887;buf[154] = (byte) (t >>> 9);t = 1317204663;buf[155] = (byte) (t >>> 17);t = -540976374;buf[156] = (byte) (t >>> 11);t = -1594629365;buf[157] = (byte) (t >>> 4);t = 634779198;buf[158] = (byte) (t >>> 14);t = -2092565459;buf[159] = (byte) (t >>> 19);t = -1458052377;buf[160] = (byte) (t >>> 18);t = 1208135361;buf[161] = (byte) (t >>> 24);t = 1508326476;buf[162] = (byte) (t >>> 22);t = 1255463450;buf[163] = (byte) (t >>> 22);t = -1967974338;buf[164] = (byte) (t >>> 21);t = 1759708247;buf[165] = (byte) (t >>> 18);t = 655432229;buf[166] = (byte) (t >>> 21);t = -935017488;buf[167] = (byte) (t >>> 16);t = -1998051771;buf[168] = (byte) (t >>> 4);t = 294965804;buf[169] = (byte) (t >>> 10);t = -1688550235;buf[170] = (byte) (t >>> 11);t = -954780914;buf[171] = (byte) (t >>> 3);t = 1603726658;buf[172] = (byte) (t >>> 12);t = 420849455;buf[173] = (byte) (t >>> 10);t = 830034624;buf[174] = (byte) (t >>> 24);t = -1837197138;buf[175] = (byte) (t >>> 2);t = -120758671;buf[176] = (byte) (t >>> 17);t = -1723522106;buf[177] = (byte) (t >>> 22);t = 1898191098;buf[178] = (byte) (t >>> 6);t = -826471077;buf[179] = (byte) (t >>> 2);t = -546675421;buf[180] = (byte) (t >>> 13);t = 2097509448;buf[181] = (byte) (t >>> 12);t = -306166035;buf[182] = (byte) (t >>> 18);t = -157642380;buf[183] = (byte) (t >>> 17);t = 1525453801;buf[184] = (byte) (t >>> 22);t = -1196921981;buf[185] = (byte) (t >>> 13);t = 332059047;buf[186] = (byte) (t >>> 3);t = 1233474474;buf[187] = (byte) (t >>> 18);t = 1967820845;buf[188] = (byte) (t >>> 20);t = -1657926524;buf[189] = (byte) (t >>> 1);t = 949882569;buf[190] = (byte) (t >>> 17);t = -1469730882;buf[191] = (byte) (t >>> 23);t = 1014507689;buf[192] = (byte) (t >>> 23);t = -654206824;buf[193] = (byte) (t >>> 22);t = -612956471;buf[194] = (byte) (t >>> 22);t = -1991614579;buf[195] = (byte) (t >>> 13);t = 1623911981;buf[196] = (byte) (t >>> 5);t = 1804444368;buf[197] = (byte) (t >>> 10);t = 1398211505;buf[198] = (byte) (t >>> 16);t = 1055407027;buf[199] = (byte) (t >>> 3);t = 110464733;buf[200] = (byte) (t >>> 17);t = -1306033798;buf[201] = (byte) (t >>> 12);t = -354811650;buf[202] = (byte) (t >>> 21);t = -947160783;buf[203] = (byte) (t >>> 2);t = -434576591;buf[204] = (byte) (t >>> 21);t = 1225529896;buf[205] = (byte) (t >>> 6);t = -311197631;buf[206] = (byte) (t >>> 12);t = -1669654242;buf[207] = (byte) (t >>> 22);t = 741547508;buf[208] = (byte) (t >>> 16);t = 1819313119;buf[209] = (byte) (t >>> 21);t = -1922889823;buf[210] = (byte) (t >>> 18);t = -596291554;buf[211] = (byte) (t >>> 10);t = 1677815302;buf[212] = (byte) (t >>> 24);t = -826498794;buf[213] = (byte) (t >>> 7);t = 188743944;buf[214] = (byte) (t >>> 2);t = -631046082;buf[215] = (byte) (t >>> 16);t = 14410394;buf[216] = (byte) (t >>> 17);t = -228682565;buf[217] = (byte) (t >>> 19);t = -898095822;buf[218] = (byte) (t >>> 19);t = 647657493;buf[219] = (byte) (t >>> 23);t = -1124945480;buf[220] = (byte) (t >>> 12);t = -1857712979;buf[221] = (byte) (t >>> 12);t = 1331122833;buf[222] = (byte) (t >>> 6);t = 1032316526;buf[223] = (byte) (t >>> 18);t = -310677852;buf[224] = (byte) (t >>> 1);t = -623718334;buf[225] = (byte) (t >>> 22);t = -855278229;buf[226] = (byte) (t >>> 13);t = -655183672;buf[227] = (byte) (t >>> 7);t = -759754539;buf[228] = (byte) (t >>> 12);t = -751321533;buf[229] = (byte) (t >>> 15);t = 1858781386;buf[230] = (byte) (t >>> 13);t = -1043922475;buf[231] = (byte) (t >>> 13);t = 2018679175;buf[232] = (byte) (t >>> 11);t = -2122537364;buf[233] = (byte) (t >>> 7);t = -572080821;buf[234] = (byte) (t >>> 12);t = 1144247563;buf[235] = (byte) (t >>> 4);t = -292639958;buf[236] = (byte) (t >>> 13);t = 573420909;buf[237] = (byte) (t >>> 23);t = -2102665440;buf[238] = (byte) (t >>> 19);t = -1708172330;buf[239] = (byte) (t >>> 16);t = 973381480;buf[240] = (byte) (t >>> 12);t = -282510229;buf[241] = (byte) (t >>> 13);t = -1925495458;buf[242] = (byte) (t >>> 4);t = 1448085172;buf[243] = (byte) (t >>> 22);t = 1434242499;buf[244] = (byte) (t >>> 20);t = -733221249;buf[245] = (byte) (t >>> 22);t = 1086635248;buf[246] = (byte) (t >>> 12);t = -1690325673;buf[247] = (byte) (t >>> 5);t = -1037143540;buf[248] = (byte) (t >>> 9);t = -283674090;buf[249] = (byte) (t >>> 3);t = -1267116662;buf[250] = (byte) (t >>> 2);t = -815018633;buf[251] = (byte) (t >>> 6);t = 1922233069;buf[252] = (byte) (t >>> 12);t = -302594417;buf[253] = (byte) (t >>> 4);t = 990731350;buf[254] = (byte) (t >>> 14);t = 1145435517;buf[255] = (byte) (t >>> 4);t = 1293715553;buf[256] = (byte) (t >>> 22);t = -1062077696;buf[257] = (byte) (t >>> 15);t = 747889858;buf[258] = (byte) (t >>> 2);t = 1921463577;buf[259] = (byte) (t >>> 4);t = -2041429450;buf[260] = (byte) (t >>> 11);t = -1979309358;buf[261] = (byte) (t >>> 1);t = -762933072;buf[262] = (byte) (t >>> 12);t = -2024214482;buf[263] = (byte) (t >>> 14);t = -964536942;buf[264] = (byte) (t >>> 8);t = 2063741120;buf[265] = (byte) (t >>> 11);t = 1391251662;buf[266] = (byte) (t >>> 17);t = -1172617622;buf[267] = (byte) (t >>> 1);t = 1869841963;buf[268] = (byte) (t >>> 5);t = 312892028;buf[269] = (byte) (t >>> 6);t = 1795685284;buf[270] = (byte) (t >>> 3);t = -648981619;buf[271] = (byte) (t >>> 18);t = 436409869;buf[272] = (byte) (t >>> 12);t = 407351594;buf[273] = (byte) (t >>> 7);t = -1217127040;buf[274] = (byte) (t >>> 12);t = 1517134577;buf[275] = (byte) (t >>> 13);t = -2085494888;buf[276] = (byte) (t >>> 15);t = 1882083963;buf[277] = (byte) (t >>> 3);t = -102345483;buf[278] = (byte) (t >>> 8);t = 1231697216;buf[279] = (byte) (t >>> 18);t = -2006506112;buf[280] = (byte) (t >>> 13);t = 1695180724;buf[281] = (byte) (t >>> 11);t = -1711531449;buf[282] = (byte) (t >>> 6);t = -1723207582;buf[283] = (byte) (t >>> 1);t = -1600639637;buf[284] = (byte) (t >>> 5);t = 690647452;buf[285] = (byte) (t >>> 9);t = 950013913;buf[286] = (byte) (t >>> 23);t = -1189928404;buf[287] = (byte) (t >>> 14);t = 610224343;buf[288] = (byte) (t >>> 8);t = 547880465;buf[289] = (byte) (t >>> 17);t = 79415647;buf[290] = (byte) (t >>> 5);t = -367860078;buf[291] = (byte) (t >>> 5);t = -524936543;buf[292] = (byte) (t >>> 3);t = 1788403996;buf[293] = (byte) (t >>> 24);t = 1561734436;buf[294] = (byte) (t >>> 5);t = 1360194166;buf[295] = (byte) (t >>> 14);t = 1360515390;buf[296] = (byte) (t >>> 18);t = -332027080;buf[297] = (byte) (t >>> 16);t = -1336414458;buf[298] = (byte) (t >>> 5);t = -1185670019;buf[299] = (byte) (t >>> 18);t = -852259274;buf[300] = (byte) (t >>> 22);t = 1818139607;buf[301] = (byte) (t >>> 9);t = -619516427;buf[302] = (byte) (t >>> 22);t = -374066813;buf[303] = (byte) (t >>> 19);t = -1639647964;buf[304] = (byte) (t >>> 16);t = -828847139;buf[305] = (byte) (t >>> 17);t = 90891831;buf[306] = (byte) (t >>> 18);t = -1778207851;buf[307] = (byte) (t >>> 7);t = 583956880;buf[308] = (byte) (t >>> 3);t = 787098659;buf[309] = (byte) (t >>> 13);t = -1705149273;buf[310] = (byte) (t >>> 22);t = 375176696;buf[311] = (byte) (t >>> 14);t = -7585739;buf[312] = (byte) (t >>> 13);t = 2058144757;buf[313] = (byte) (t >>> 13);t = -663781391;buf[314] = (byte) (t >>> 17);t = 698930848;buf[315] = (byte) (t >>> 23);t = -813080237;buf[316] = (byte) (t >>> 13);t = 180262293;buf[317] = (byte) (t >>> 19);t = 1268615896;buf[318] = (byte) (t >>> 19);t = -1478814726;buf[319] = (byte) (t >>> 6);t = 1663948894;buf[320] = (byte) (t >>> 6);t = -1899236506;buf[321] = (byte) (t >>> 4);t = -962217551;buf[322] = (byte) (t >>> 7);t = -1076449658;buf[323] = (byte) (t >>> 1);t = 2026755941;buf[324] = (byte) (t >>> 18);t = 1563009793;buf[325] = (byte) (t >>> 13);t = -1719520795;buf[326] = (byte) (t >>> 8);t = 1622739181;buf[327] = (byte) (t >>> 5);t = -13940788;buf[328] = (byte) (t >>> 8);t = 2117719315;buf[329] = (byte) (t >>> 6);t = 1084594803;buf[330] = (byte) (t >>> 15);t = 1217183201;buf[331] = (byte) (t >>> 13);t = -1297563702;buf[332] = (byte) (t >>> 23);t = -1539256195;buf[333] = (byte) (t >>> 10);t = -617354133;buf[334] = (byte) (t >>> 19);t = -507354536;buf[335] = (byte) (t >>> 3);t = 1796763628;buf[336] = (byte) (t >>> 24);t = -429044413;buf[337] = (byte) (t >>> 13);t = -1340551820;buf[338] = (byte) (t >>> 6);t = -850609823;buf[339] = (byte) (t >>> 21);t = -737818992;buf[340] = (byte) (t >>> 22);t = -295335586;buf[341] = (byte) (t >>> 12);t = 515677767;buf[342] = (byte) (t >>> 15);t = -515212155;buf[343] = (byte) (t >>> 1);t = 1626490219;buf[344] = (byte) (t >>> 17);t = 1227629498;buf[345] = (byte) (t >>> 24);t = 1225500465;buf[346] = (byte) (t >>> 18);t = -1373152920;buf[347] = (byte) (t >>> 8);t = 1651792004;buf[348] = (byte) (t >>> 6);t = 1369491512;buf[349] = (byte) (t >>> 18);t = 1201308821;buf[350] = (byte) (t >>> 9);t = -1850934937;buf[351] = (byte) (t >>> 22);t = 1897253686;buf[352] = (byte) (t >>> 24);t = 1801609773;buf[353] = (byte) (t >>> 24);t = 1831787240;buf[354] = (byte) (t >>> 6);t = 764960890;buf[355] = (byte) (t >>> 15);t = -724778786;buf[356] = (byte) (t >>> 2);t = -744335647;buf[357] = (byte) (t >>> 22);t = 575859123;buf[358] = (byte) (t >>> 14);t = -1521416236;buf[359] = (byte) (t >>> 20);t = -1721189038;buf[360] = (byte) (t >>> 2);t = 2118905874;buf[361] = (byte) (t >>> 14);t = -1204445419;buf[362] = (byte) (t >>> 15);t = 1973637900;buf[363] = (byte) (t >>> 4);t = 1905139815;buf[364] = (byte) (t >>> 24);t = 1551255406;buf[365] = (byte) (t >>> 8);t = 1043560747;buf[366] = (byte) (t >>> 2);t = 621061421;buf[367] = (byte) (t >>> 18);t = -929433691;buf[368] = (byte) (t >>> 4);t = 700746268;buf[369] = (byte) (t >>> 9);t = 318846565;buf[370] = (byte) (t >>> 1);t = -530912876;buf[371] = (byte) (t >>> 5);t = 147329306;buf[372] = (byte) (t >>> 2);t = 1819424564;buf[373] = (byte) (t >>> 16);t = 1759027219;buf[374] = (byte) (t >>> 17);t = 354677693;buf[375] = (byte) (t >>> 3);t = 1754618062;buf[376] = (byte) (t >>> 1);t = 1963150402;buf[377] = (byte) (t >>> 20);t = 1833078534;buf[378] = (byte) (t >>> 9);t = -741292473;buf[379] = (byte) (t >>> 4);t = 899193310;buf[380] = (byte) (t >>> 7);t = 1672227783;buf[381] = (byte) (t >>> 7);t = 446436431;buf[382] = (byte) (t >>> 17);t = 768639603;buf[383] = (byte) (t >>> 21);t = -645172320;buf[384] = (byte) (t >>> 22);t = 787303864;buf[385] = (byte) (t >>> 21);t = -131446140;buf[386] = (byte) (t >>> 11);t = 867207513;buf[387] = (byte) (t >>> 9);t = 1031656708;buf[388] = (byte) (t >>> 2);t = 532474429;buf[389] = (byte) (t >>> 5);t = 1210191183;buf[390] = (byte) (t >>> 21);t = 1485090154;buf[391] = (byte) (t >>> 17);return new String(buf);}}.toString());

    @Test
    public void obfuscatedPublicKeyExample(){
        String obfuscatedPublicKey = Obfuscator.getObfuscatedCode(PUBLIC_KEY);
        System.out.println(obfuscatedPublicKey);
        /* Since it tedious to compile java code in string to expression we are using the expression directly */
        String publicKeyObfuscated = (new Object() {int t;public String toString() {byte[] buf = new byte[392];t = -374855393;buf[0] = (byte) (t >>> 21);t = 1233261869;buf[1] = (byte) (t >>> 24);t = -766304181;buf[2] = (byte) (t >>> 22);t = 356661191;buf[3] = (byte) (t >>> 16);t = -50704785;buf[4] = (byte) (t >>> 11);t = -151472777;buf[5] = (byte) (t >>> 7);t = -1596327440;buf[6] = (byte) (t >>> 23);t = -1474008624;buf[7] = (byte) (t >>> 5);t = 338858142;buf[8] = (byte) (t >>> 6);t = -1360566882;buf[9] = (byte) (t >>> 2);t = -1492113194;buf[10] = (byte) (t >>> 1);t = 955248336;buf[11] = (byte) (t >>> 23);t = -317500319;buf[12] = (byte) (t >>> 21);t = 2146283515;buf[13] = (byte) (t >>> 10);t = 1795914568;buf[14] = (byte) (t >>> 3);t = 37231553;buf[15] = (byte) (t >>> 19);t = 70575174;buf[16] = (byte) (t >>> 10);t = 1284225610;buf[17] = (byte) (t >>> 11);t = -1906763772;buf[18] = (byte) (t >>> 7);t = 1990744402;buf[19] = (byte) (t >>> 13);t = -492776020;buf[20] = (byte) (t >>> 15);t = -576051684;buf[21] = (byte) (t >>> 13);t = 975970751;buf[22] = (byte) (t >>> 19);t = 1413769893;buf[23] = (byte) (t >>> 12);t = -1542470394;buf[24] = (byte) (t >>> 2);t = 1603302941;buf[25] = (byte) (t >>> 14);t = 910818480;buf[26] = (byte) (t >>> 13);t = -391210738;buf[27] = (byte) (t >>> 2);t = -1664869987;buf[28] = (byte) (t >>> 12);t = 2091536878;buf[29] = (byte) (t >>> 8);t = 1311736952;buf[30] = (byte) (t >>> 22);t = 779944995;buf[31] = (byte) (t >>> 10);t = 1565002155;buf[32] = (byte) (t >>> 5);t = -728569692;buf[33] = (byte) (t >>> 17);t = 1230371533;buf[34] = (byte) (t >>> 24);t = 1111566614;buf[35] = (byte) (t >>> 24);t = -519211840;buf[36] = (byte) (t >>> 18);t = 346874695;buf[37] = (byte) (t >>> 13);t = 1518553977;buf[38] = (byte) (t >>> 8);t = -1808703394;buf[39] = (byte) (t >>> 20);t = -1597062272;buf[40] = (byte) (t >>> 23);t = -262908076;buf[41] = (byte) (t >>> 14);t = 170484185;buf[42] = (byte) (t >>> 19);t = 276542115;buf[43] = (byte) (t >>> 22);t = 780261602;buf[44] = (byte) (t >>> 21);t = 1054421820;buf[45] = (byte) (t >>> 4);t = -699995809;buf[46] = (byte) (t >>> 12);t = -1608832091;buf[47] = (byte) (t >>> 3);t = 1997714131;buf[48] = (byte) (t >>> 20);t = -1427583261;buf[49] = (byte) (t >>> 13);t = -1137805407;buf[50] = (byte) (t >>> 4);t = -1689511876;buf[51] = (byte) (t >>> 14);t = -130771695;buf[52] = (byte) (t >>> 9);t = -1394020895;buf[53] = (byte) (t >>> 5);t = -1133555705;buf[54] = (byte) (t >>> 16);t = 591032803;buf[55] = (byte) (t >>> 15);t = 1250369457;buf[56] = (byte) (t >>> 17);t = 826006340;buf[57] = (byte) (t >>> 6);t = -1049781008;buf[58] = (byte) (t >>> 7);t = 1455367081;buf[59] = (byte) (t >>> 7);t = 1513391514;buf[60] = (byte) (t >>> 12);t = -1226031220;buf[61] = (byte) (t >>> 17);t = 937832068;buf[62] = (byte) (t >>> 1);t = 1286440887;buf[63] = (byte) (t >>> 17);t = -1053584632;buf[64] = (byte) (t >>> 18);t = -1074984322;buf[65] = (byte) (t >>> 3);t = 1124326709;buf[66] = (byte) (t >>> 24);t = 65227564;buf[67] = (byte) (t >>> 3);t = 677712905;buf[68] = (byte) (t >>> 17);t = 825927250;buf[69] = (byte) (t >>> 9);t = 734149040;buf[70] = (byte) (t >>> 2);t = -1659567780;buf[71] = (byte) (t >>> 18);t = 915909379;buf[72] = (byte) (t >>> 20);t = -2084133227;buf[73] = (byte) (t >>> 19);t = -988780835;buf[74] = (byte) (t >>> 20);t = 1454169676;buf[75] = (byte) (t >>> 9);t = 170534700;buf[76] = (byte) (t >>> 21);t = -896404152;buf[77] = (byte) (t >>> 4);t = 925583852;buf[78] = (byte) (t >>> 16);t = -1556011208;buf[79] = (byte) (t >>> 10);t = 281733681;buf[80] = (byte) (t >>> 3);t = 1152049583;buf[81] = (byte) (t >>> 15);t = 1867956003;buf[82] = (byte) (t >>> 16);t = 2109234510;buf[83] = (byte) (t >>> 18);t = 1607959728;buf[84] = (byte) (t >>> 4);t = 1420735354;buf[85] = (byte) (t >>> 3);t = 1279792445;buf[86] = (byte) (t >>> 16);t = 1358669017;buf[87] = (byte) (t >>> 1);t = -471825603;buf[88] = (byte) (t >>> 4);t = 1211220463;buf[89] = (byte) (t >>> 24);t = 465296518;buf[90] = (byte) (t >>> 23);t = -1330569034;buf[91] = (byte) (t >>> 7);t = -376182527;buf[92] = (byte) (t >>> 19);t = -1087135786;buf[93] = (byte) (t >>> 16);t = 556866209;buf[94] = (byte) (t >>> 6);t = -298755734;buf[95] = (byte) (t >>> 8);t = 1937722198;buf[96] = (byte) (t >>> 19);t = -515157108;buf[97] = (byte) (t >>> 6);t = 212806594;buf[98] = (byte) (t >>> 7);t = -1894471286;buf[99] = (byte) (t >>> 9);t = 897386380;buf[100] = (byte) (t >>> 23);t = -1372862351;buf[101] = (byte) (t >>> 1);t = -208485195;buf[102] = (byte) (t >>> 14);t = -499944247;buf[103] = (byte) (t >>> 8);t = 453532840;buf[104] = (byte) (t >>> 13);t = -1851154950;buf[105] = (byte) (t >>> 10);t = -2082469235;buf[106] = (byte) (t >>> 3);t = 1016621326;buf[107] = (byte) (t >>> 14);t = 355887744;buf[108] = (byte) (t >>> 12);t = -423203553;buf[109] = (byte) (t >>> 17);t = 1630163285;buf[110] = (byte) (t >>> 6);t = 1175216755;buf[111] = (byte) (t >>> 24);t = -590374848;buf[112] = (byte) (t >>> 22);t = -523556882;buf[113] = (byte) (t >>> 11);t = 40455931;buf[114] = (byte) (t >>> 17);t = 1475980743;buf[115] = (byte) (t >>> 10);t = 483760231;buf[116] = (byte) (t >>> 7);t = 11055998;buf[117] = (byte) (t >>> 15);t = 1236746370;buf[118] = (byte) (t >>> 1);t = 1482392925;buf[119] = (byte) (t >>> 2);t = 409897499;buf[120] = (byte) (t >>> 3);t = -1580353699;buf[121] = (byte) (t >>> 19);t = 673401521;buf[122] = (byte) (t >>> 21);t = 909461499;buf[123] = (byte) (t >>> 10);t = -779911407;buf[124] = (byte) (t >>> 19);t = 531862539;buf[125] = (byte) (t >>> 11);t = 9382097;buf[126] = (byte) (t >>> 5);t = -631063940;buf[127] = (byte) (t >>> 22);t = 678759132;buf[128] = (byte) (t >>> 1);t = -973501059;buf[129] = (byte) (t >>> 10);t = 207885189;buf[130] = (byte) (t >>> 3);t = 91376336;buf[131] = (byte) (t >>> 1);t = 1539984009;buf[132] = (byte) (t >>> 22);t = -1842195046;buf[133] = (byte) (t >>> 15);t = 1140000102;buf[134] = (byte) (t >>> 5);t = -153423387;buf[135] = (byte) (t >>> 20);t = -1447257170;buf[136] = (byte) (t >>> 18);t = 754153153;buf[137] = (byte) (t >>> 17);t = 1524396291;buf[138] = (byte) (t >>> 24);t = -1126754906;buf[139] = (byte) (t >>> 7);t = -1253470692;buf[140] = (byte) (t >>> 20);t = -1564213694;buf[141] = (byte) (t >>> 19);t = -1164089508;buf[142] = (byte) (t >>> 14);t = -1080351123;buf[143] = (byte) (t >>> 5);t = 1494555488;buf[144] = (byte) (t >>> 6);t = -817858080;buf[145] = (byte) (t >>> 8);t = 832217816;buf[146] = (byte) (t >>> 9);t = -26829081;buf[147] = (byte) (t >>> 12);t = 2068223192;buf[148] = (byte) (t >>> 2);t = 678789973;buf[149] = (byte) (t >>> 23);t = -205086352;buf[150] = (byte) (t >>> 13);t = -1478439047;buf[151] = (byte) (t >>> 10);t = -1868209479;buf[152] = (byte) (t >>> 15);t = -1892914994;buf[153] = (byte) (t >>> 15);t = -1452503887;buf[154] = (byte) (t >>> 9);t = 1317204663;buf[155] = (byte) (t >>> 17);t = -540976374;buf[156] = (byte) (t >>> 11);t = -1594629365;buf[157] = (byte) (t >>> 4);t = 634779198;buf[158] = (byte) (t >>> 14);t = -2092565459;buf[159] = (byte) (t >>> 19);t = -1458052377;buf[160] = (byte) (t >>> 18);t = 1208135361;buf[161] = (byte) (t >>> 24);t = 1508326476;buf[162] = (byte) (t >>> 22);t = 1255463450;buf[163] = (byte) (t >>> 22);t = -1967974338;buf[164] = (byte) (t >>> 21);t = 1759708247;buf[165] = (byte) (t >>> 18);t = 655432229;buf[166] = (byte) (t >>> 21);t = -935017488;buf[167] = (byte) (t >>> 16);t = -1998051771;buf[168] = (byte) (t >>> 4);t = 294965804;buf[169] = (byte) (t >>> 10);t = -1688550235;buf[170] = (byte) (t >>> 11);t = -954780914;buf[171] = (byte) (t >>> 3);t = 1603726658;buf[172] = (byte) (t >>> 12);t = 420849455;buf[173] = (byte) (t >>> 10);t = 830034624;buf[174] = (byte) (t >>> 24);t = -1837197138;buf[175] = (byte) (t >>> 2);t = -120758671;buf[176] = (byte) (t >>> 17);t = -1723522106;buf[177] = (byte) (t >>> 22);t = 1898191098;buf[178] = (byte) (t >>> 6);t = -826471077;buf[179] = (byte) (t >>> 2);t = -546675421;buf[180] = (byte) (t >>> 13);t = 2097509448;buf[181] = (byte) (t >>> 12);t = -306166035;buf[182] = (byte) (t >>> 18);t = -157642380;buf[183] = (byte) (t >>> 17);t = 1525453801;buf[184] = (byte) (t >>> 22);t = -1196921981;buf[185] = (byte) (t >>> 13);t = 332059047;buf[186] = (byte) (t >>> 3);t = 1233474474;buf[187] = (byte) (t >>> 18);t = 1967820845;buf[188] = (byte) (t >>> 20);t = -1657926524;buf[189] = (byte) (t >>> 1);t = 949882569;buf[190] = (byte) (t >>> 17);t = -1469730882;buf[191] = (byte) (t >>> 23);t = 1014507689;buf[192] = (byte) (t >>> 23);t = -654206824;buf[193] = (byte) (t >>> 22);t = -612956471;buf[194] = (byte) (t >>> 22);t = -1991614579;buf[195] = (byte) (t >>> 13);t = 1623911981;buf[196] = (byte) (t >>> 5);t = 1804444368;buf[197] = (byte) (t >>> 10);t = 1398211505;buf[198] = (byte) (t >>> 16);t = 1055407027;buf[199] = (byte) (t >>> 3);t = 110464733;buf[200] = (byte) (t >>> 17);t = -1306033798;buf[201] = (byte) (t >>> 12);t = -354811650;buf[202] = (byte) (t >>> 21);t = -947160783;buf[203] = (byte) (t >>> 2);t = -434576591;buf[204] = (byte) (t >>> 21);t = 1225529896;buf[205] = (byte) (t >>> 6);t = -311197631;buf[206] = (byte) (t >>> 12);t = -1669654242;buf[207] = (byte) (t >>> 22);t = 741547508;buf[208] = (byte) (t >>> 16);t = 1819313119;buf[209] = (byte) (t >>> 21);t = -1922889823;buf[210] = (byte) (t >>> 18);t = -596291554;buf[211] = (byte) (t >>> 10);t = 1677815302;buf[212] = (byte) (t >>> 24);t = -826498794;buf[213] = (byte) (t >>> 7);t = 188743944;buf[214] = (byte) (t >>> 2);t = -631046082;buf[215] = (byte) (t >>> 16);t = 14410394;buf[216] = (byte) (t >>> 17);t = -228682565;buf[217] = (byte) (t >>> 19);t = -898095822;buf[218] = (byte) (t >>> 19);t = 647657493;buf[219] = (byte) (t >>> 23);t = -1124945480;buf[220] = (byte) (t >>> 12);t = -1857712979;buf[221] = (byte) (t >>> 12);t = 1331122833;buf[222] = (byte) (t >>> 6);t = 1032316526;buf[223] = (byte) (t >>> 18);t = -310677852;buf[224] = (byte) (t >>> 1);t = -623718334;buf[225] = (byte) (t >>> 22);t = -855278229;buf[226] = (byte) (t >>> 13);t = -655183672;buf[227] = (byte) (t >>> 7);t = -759754539;buf[228] = (byte) (t >>> 12);t = -751321533;buf[229] = (byte) (t >>> 15);t = 1858781386;buf[230] = (byte) (t >>> 13);t = -1043922475;buf[231] = (byte) (t >>> 13);t = 2018679175;buf[232] = (byte) (t >>> 11);t = -2122537364;buf[233] = (byte) (t >>> 7);t = -572080821;buf[234] = (byte) (t >>> 12);t = 1144247563;buf[235] = (byte) (t >>> 4);t = -292639958;buf[236] = (byte) (t >>> 13);t = 573420909;buf[237] = (byte) (t >>> 23);t = -2102665440;buf[238] = (byte) (t >>> 19);t = -1708172330;buf[239] = (byte) (t >>> 16);t = 973381480;buf[240] = (byte) (t >>> 12);t = -282510229;buf[241] = (byte) (t >>> 13);t = -1925495458;buf[242] = (byte) (t >>> 4);t = 1448085172;buf[243] = (byte) (t >>> 22);t = 1434242499;buf[244] = (byte) (t >>> 20);t = -733221249;buf[245] = (byte) (t >>> 22);t = 1086635248;buf[246] = (byte) (t >>> 12);t = -1690325673;buf[247] = (byte) (t >>> 5);t = -1037143540;buf[248] = (byte) (t >>> 9);t = -283674090;buf[249] = (byte) (t >>> 3);t = -1267116662;buf[250] = (byte) (t >>> 2);t = -815018633;buf[251] = (byte) (t >>> 6);t = 1922233069;buf[252] = (byte) (t >>> 12);t = -302594417;buf[253] = (byte) (t >>> 4);t = 990731350;buf[254] = (byte) (t >>> 14);t = 1145435517;buf[255] = (byte) (t >>> 4);t = 1293715553;buf[256] = (byte) (t >>> 22);t = -1062077696;buf[257] = (byte) (t >>> 15);t = 747889858;buf[258] = (byte) (t >>> 2);t = 1921463577;buf[259] = (byte) (t >>> 4);t = -2041429450;buf[260] = (byte) (t >>> 11);t = -1979309358;buf[261] = (byte) (t >>> 1);t = -762933072;buf[262] = (byte) (t >>> 12);t = -2024214482;buf[263] = (byte) (t >>> 14);t = -964536942;buf[264] = (byte) (t >>> 8);t = 2063741120;buf[265] = (byte) (t >>> 11);t = 1391251662;buf[266] = (byte) (t >>> 17);t = -1172617622;buf[267] = (byte) (t >>> 1);t = 1869841963;buf[268] = (byte) (t >>> 5);t = 312892028;buf[269] = (byte) (t >>> 6);t = 1795685284;buf[270] = (byte) (t >>> 3);t = -648981619;buf[271] = (byte) (t >>> 18);t = 436409869;buf[272] = (byte) (t >>> 12);t = 407351594;buf[273] = (byte) (t >>> 7);t = -1217127040;buf[274] = (byte) (t >>> 12);t = 1517134577;buf[275] = (byte) (t >>> 13);t = -2085494888;buf[276] = (byte) (t >>> 15);t = 1882083963;buf[277] = (byte) (t >>> 3);t = -102345483;buf[278] = (byte) (t >>> 8);t = 1231697216;buf[279] = (byte) (t >>> 18);t = -2006506112;buf[280] = (byte) (t >>> 13);t = 1695180724;buf[281] = (byte) (t >>> 11);t = -1711531449;buf[282] = (byte) (t >>> 6);t = -1723207582;buf[283] = (byte) (t >>> 1);t = -1600639637;buf[284] = (byte) (t >>> 5);t = 690647452;buf[285] = (byte) (t >>> 9);t = 950013913;buf[286] = (byte) (t >>> 23);t = -1189928404;buf[287] = (byte) (t >>> 14);t = 610224343;buf[288] = (byte) (t >>> 8);t = 547880465;buf[289] = (byte) (t >>> 17);t = 79415647;buf[290] = (byte) (t >>> 5);t = -367860078;buf[291] = (byte) (t >>> 5);t = -524936543;buf[292] = (byte) (t >>> 3);t = 1788403996;buf[293] = (byte) (t >>> 24);t = 1561734436;buf[294] = (byte) (t >>> 5);t = 1360194166;buf[295] = (byte) (t >>> 14);t = 1360515390;buf[296] = (byte) (t >>> 18);t = -332027080;buf[297] = (byte) (t >>> 16);t = -1336414458;buf[298] = (byte) (t >>> 5);t = -1185670019;buf[299] = (byte) (t >>> 18);t = -852259274;buf[300] = (byte) (t >>> 22);t = 1818139607;buf[301] = (byte) (t >>> 9);t = -619516427;buf[302] = (byte) (t >>> 22);t = -374066813;buf[303] = (byte) (t >>> 19);t = -1639647964;buf[304] = (byte) (t >>> 16);t = -828847139;buf[305] = (byte) (t >>> 17);t = 90891831;buf[306] = (byte) (t >>> 18);t = -1778207851;buf[307] = (byte) (t >>> 7);t = 583956880;buf[308] = (byte) (t >>> 3);t = 787098659;buf[309] = (byte) (t >>> 13);t = -1705149273;buf[310] = (byte) (t >>> 22);t = 375176696;buf[311] = (byte) (t >>> 14);t = -7585739;buf[312] = (byte) (t >>> 13);t = 2058144757;buf[313] = (byte) (t >>> 13);t = -663781391;buf[314] = (byte) (t >>> 17);t = 698930848;buf[315] = (byte) (t >>> 23);t = -813080237;buf[316] = (byte) (t >>> 13);t = 180262293;buf[317] = (byte) (t >>> 19);t = 1268615896;buf[318] = (byte) (t >>> 19);t = -1478814726;buf[319] = (byte) (t >>> 6);t = 1663948894;buf[320] = (byte) (t >>> 6);t = -1899236506;buf[321] = (byte) (t >>> 4);t = -962217551;buf[322] = (byte) (t >>> 7);t = -1076449658;buf[323] = (byte) (t >>> 1);t = 2026755941;buf[324] = (byte) (t >>> 18);t = 1563009793;buf[325] = (byte) (t >>> 13);t = -1719520795;buf[326] = (byte) (t >>> 8);t = 1622739181;buf[327] = (byte) (t >>> 5);t = -13940788;buf[328] = (byte) (t >>> 8);t = 2117719315;buf[329] = (byte) (t >>> 6);t = 1084594803;buf[330] = (byte) (t >>> 15);t = 1217183201;buf[331] = (byte) (t >>> 13);t = -1297563702;buf[332] = (byte) (t >>> 23);t = -1539256195;buf[333] = (byte) (t >>> 10);t = -617354133;buf[334] = (byte) (t >>> 19);t = -507354536;buf[335] = (byte) (t >>> 3);t = 1796763628;buf[336] = (byte) (t >>> 24);t = -429044413;buf[337] = (byte) (t >>> 13);t = -1340551820;buf[338] = (byte) (t >>> 6);t = -850609823;buf[339] = (byte) (t >>> 21);t = -737818992;buf[340] = (byte) (t >>> 22);t = -295335586;buf[341] = (byte) (t >>> 12);t = 515677767;buf[342] = (byte) (t >>> 15);t = -515212155;buf[343] = (byte) (t >>> 1);t = 1626490219;buf[344] = (byte) (t >>> 17);t = 1227629498;buf[345] = (byte) (t >>> 24);t = 1225500465;buf[346] = (byte) (t >>> 18);t = -1373152920;buf[347] = (byte) (t >>> 8);t = 1651792004;buf[348] = (byte) (t >>> 6);t = 1369491512;buf[349] = (byte) (t >>> 18);t = 1201308821;buf[350] = (byte) (t >>> 9);t = -1850934937;buf[351] = (byte) (t >>> 22);t = 1897253686;buf[352] = (byte) (t >>> 24);t = 1801609773;buf[353] = (byte) (t >>> 24);t = 1831787240;buf[354] = (byte) (t >>> 6);t = 764960890;buf[355] = (byte) (t >>> 15);t = -724778786;buf[356] = (byte) (t >>> 2);t = -744335647;buf[357] = (byte) (t >>> 22);t = 575859123;buf[358] = (byte) (t >>> 14);t = -1521416236;buf[359] = (byte) (t >>> 20);t = -1721189038;buf[360] = (byte) (t >>> 2);t = 2118905874;buf[361] = (byte) (t >>> 14);t = -1204445419;buf[362] = (byte) (t >>> 15);t = 1973637900;buf[363] = (byte) (t >>> 4);t = 1905139815;buf[364] = (byte) (t >>> 24);t = 1551255406;buf[365] = (byte) (t >>> 8);t = 1043560747;buf[366] = (byte) (t >>> 2);t = 621061421;buf[367] = (byte) (t >>> 18);t = -929433691;buf[368] = (byte) (t >>> 4);t = 700746268;buf[369] = (byte) (t >>> 9);t = 318846565;buf[370] = (byte) (t >>> 1);t = -530912876;buf[371] = (byte) (t >>> 5);t = 147329306;buf[372] = (byte) (t >>> 2);t = 1819424564;buf[373] = (byte) (t >>> 16);t = 1759027219;buf[374] = (byte) (t >>> 17);t = 354677693;buf[375] = (byte) (t >>> 3);t = 1754618062;buf[376] = (byte) (t >>> 1);t = 1963150402;buf[377] = (byte) (t >>> 20);t = 1833078534;buf[378] = (byte) (t >>> 9);t = -741292473;buf[379] = (byte) (t >>> 4);t = 899193310;buf[380] = (byte) (t >>> 7);t = 1672227783;buf[381] = (byte) (t >>> 7);t = 446436431;buf[382] = (byte) (t >>> 17);t = 768639603;buf[383] = (byte) (t >>> 21);t = -645172320;buf[384] = (byte) (t >>> 22);t = 787303864;buf[385] = (byte) (t >>> 21);t = -131446140;buf[386] = (byte) (t >>> 11);t = 867207513;buf[387] = (byte) (t >>> 9);t = 1031656708;buf[388] = (byte) (t >>> 2);t = 532474429;buf[389] = (byte) (t >>> 5);t = 1210191183;buf[390] = (byte) (t >>> 21);t = 1485090154;buf[391] = (byte) (t >>> 17);return new String(buf);}}.toString());
        assertTrue("Obfuscated public key should match original key", PUBLIC_KEY.equalsIgnoreCase(publicKeyObfuscated));
        assertTrue("Obfuscated public key should match original key", PUBLIC_KEY.equalsIgnoreCase(OBFUSCATED_PUBLIC_KEY));
    }

    @Test
    public void check_initialization(){

        String rawdata = "2019-06-01T18:30:27.298||2019-06-07T18:30:27.298||"+ LocalDateTime.now().plusMinutes(3)+"||2019-06-05T12:59:27.298";

        String certificateContent = null;
        try {
            certificateContent = CertificateUtil.encrypt(rawdata, PRIVATE_KEY);
        } catch (Exception e) {
            e.printStackTrace();
        }

        String certificatePath = createTempCertificate(certificateContent);
        System.setProperty("cv.secureapp.certificate", certificatePath);
        SecurityContextBuilder.withDefault().withPublicKey(OBFUSCATED_PUBLIC_KEY).initialize();

        /* It must throw java.lang.RuntimeException: Certificate Expired on  */
        SecurityContext.isCertificateValid();
    }

    @Test(expected = CertificateExpiredException.class)
    public void check_expire_certificate(){

        String rawdata = "2019-06-01T18:30:27.298||2019-06-07T18:30:27.298||"+ LocalDateTime.now().minusMinutes(3)+"||2019-06-05T12:59:27.298";

        String certificateContent = null;
        try {
            certificateContent = CertificateUtil.encrypt(rawdata, PRIVATE_KEY);
        } catch (Exception e) {
            e.printStackTrace();
        }
        String certificatePath = createTempCertificate(certificateContent);
        System.setProperty("cv.secureapp.certificate", certificatePath);
        assertFalse("It should give runtime expection Certificate Expired on ", false);
        SecurityContextBuilder.withDefault().withPublicKey(OBFUSCATED_PUBLIC_KEY).initialize();

        /* It must throw java.lang.RuntimeException: Certificate Expired on  */
        SecurityContext.isCertificateValid();
    }

    @Test
    public void certificate_validity_within_timeframe(){

        String rawdata = "2019-06-01T18:30:27.298||2019-06-07T18:30:27.298||"+ LocalDateTime.now().plusMinutes(2)+"||2019-06-05T12:59:27.298";

        String certificateContent = null;
        try {
            certificateContent = CertificateUtil.encrypt(rawdata, PRIVATE_KEY);
        } catch (Exception e) {
            e.printStackTrace();
        }
        String certificatePath = createTempCertificate(certificateContent);
        System.setProperty("cv.secureapp.certificate", certificatePath);
        try {
            Thread.sleep(1 * 60 * 1000L); // Sleep for 1 minute and the check
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        SecurityContextBuilder.withDefault().withPublicKey(OBFUSCATED_PUBLIC_KEY).initialize();
        SecurityContext.isCertificateValid();
    }

    @Test(expected = CertificateExpiredException.class)
    public void certificate_validity_outside_timeframe(){

        String rawdata = "2019-06-01T18:30:27.298||2019-06-07T18:30:27.298||"+ LocalDateTime.now().plusSeconds(30)+"||2019-06-05T12:59:27.298";

        try {
            String certificateContent = CertificateUtil.encrypt(rawdata, PRIVATE_KEY);
            String certificatePath = createTempCertificate(certificateContent);
            System.setProperty("cv.secureapp.certificate", certificatePath);
            Thread.sleep(1 * 60 * 1000L); // Sleep for 1 minute and the check
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }

        SecurityContextBuilder.withDefault().withPublicKey(OBFUSCATED_PUBLIC_KEY).initialize();

        /* It must throw java.lang.RuntimeException: Certificate Expired on  */
        SecurityContext.isCertificateValid();

    }

    @Test(expected = CertificateExpiredException.class)
    public void certificate_validity_on_larger_timeframe(){

        String rawdata = "2019-06-01T18:30:27.298||2019-06-07T18:30:27.298||"+ LocalDateTime.now().plusMinutes(2)+"||2019-06-05T12:59:27.298";
        try {
            String certificateContent = CertificateUtil.encrypt(rawdata, PRIVATE_KEY);
            String certificatePath = createTempCertificate(certificateContent);
            System.setProperty("cv.secureapp.certificate", certificatePath);
            Thread.sleep(1 * 60 * 1000L); // Sleep for 1 minute and the check

            SecurityContextBuilder.withDefault().withPublicKey(OBFUSCATED_PUBLIC_KEY).initialize();
            SecurityContext.isCertificateValid();
            Thread.sleep(1 * 60 * 1000L); // Again sleep for 2 minute and the check

        } catch (Exception e) {
            e.printStackTrace();
        }

        /* It must throw java.lang.RuntimeException: Certificate Expired on  */
        SecurityContext.isCertificateValid();
    }

    public static String createTempCertificate(String certificateContent){

        File tempFile = null;
        try {
            tempFile = File.createTempFile("CERT-",".cipher");
            BufferedWriter bw = new BufferedWriter(new FileWriter(tempFile));
            bw.write(certificateContent);
            bw.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return tempFile.getAbsolutePath();
    }
}
